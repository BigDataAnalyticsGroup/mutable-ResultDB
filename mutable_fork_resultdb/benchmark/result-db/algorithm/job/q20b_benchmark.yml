description: Join-Order Benchmark q20b.
suite: result-db
benchmark: job
name: q20b
readonly: true
chart:
    x:
        scale: linear
        type: O
        label: JOB Queries
    y:
        scale: linear
        type: Q
        label: 'Execution time [ms]'
    # Defaults: scale is "linear", type is "Q", label is "X" or "Y"
data:
    'complete_cast':
        file: 'benchmark/job/data/complete_cast.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'movie_id': 'INT'
            'subject_id': 'INT NOT NULL'
            'status_id': 'INT NOT NULL'
    'comp_cast_type':
        file: 'benchmark/job/data/comp_cast_type.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'kind': 'CHAR 32 NOT NULL'
    'comp_cast_type':
        file: 'benchmark/job/data/comp_cast_type.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'kind': 'CHAR 32 NOT NULL'
    'char_name':
        file: 'benchmark/job/data/char_name.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'name': 'CHAR 100 NOT NULL'
            'imdb_index': 'CHAR 2'
            'imdb_id': 'INT'
            'name_pcode_nf': 'CHAR 5'
            'surname_pcode': 'CHAR 5'
            'md5sum': 'CHAR 32'
    'cast_info':
        file: 'benchmark/job/data/cast_info.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'person_id': 'INT NOT NULL'
            'movie_id': 'INT NOT NULL'
            'person_role_id': 'INT'
            'note': 'CHAR 18'
            'nr_order': 'INT'
            'role_id': 'INT NOT NULL'
    'keyword':
        file: 'benchmark/job/data/keyword.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'keyword': 'CHAR 74 NOT NULL'
            'phonetic_code': 'CHAR 5'
    'kind_type':
        file: 'benchmark/job/data/kind_type.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'kind': 'CHAR 15 NOT NULL'
    'movie_keyword':
        file: 'benchmark/job/data/movie_keyword.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'movie_id': 'INT NOT NULL'
            'keyword_id': 'INT NOT NULL'
    'name':
        file: 'benchmark/job/data/name.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'name': 'CHAR 100 NOT NULL'
            'imdb_index': 'CHAR 9'
            'imdb_id': 'INT'
            'gender': 'CHAR 1'
            'name_pcode_cf': 'CHAR 5'
            'name_pcode_nf': 'CHAR 5'
            'surname_pcode': 'CHAR 5'
            'md5sum': 'CHAR 32'
    'title':
        file: 'benchmark/job/data/title.csv'
        format: 'csv'
        delimiter: ','
        header: 0
        attributes:
            'id': 'INT NOT NULL'
            'title': 'CHAR 100 NOT NULL'
            'imdb_index': 'CHAR 5'
            'kind_id': 'INT NOT NULL'
            'production_year': 'INT'
            'imdb_id': 'INT'
            'phonetic_code': 'CHAR 5'
            'episode_of_id': 'INT'
            'season_nr': 'INT'
            'episode_nr': 'INT'
            'series_years': 'CHAR 9'
            'md5sum': 'CHAR 32'


systems:
    mutable:
        args: >-
          --backend WasmV8
          --no-simd
          --cardinality-estimator Injected
          --use-cardinality-file benchmark/result-db/algorithm/job/q20b_cardinalities.json
          --insist-no-rehashing
        configurations:                                   # Different experiment configurations.
            'WasmV8, resultdb':
                args: --result-db
                pattern: '^Execute machine code:.*'
            'WasmV8, decompose':
                args: --decompose
                pattern: '^Execute machine code:.*'
            'WasmV8, single-table':
                args: ''
                pattern: '^Execute machine code:.*'
        cases:
            0: 'SELECT t.title FROM complete_cast AS cc, comp_cast_type AS cct1, comp_cast_type AS cct2, char_name AS chn, cast_info AS ci, keyword AS k, kind_type AS kt, movie_keyword AS mk, name AS n, title AS t WHERE cct1.kind = "cast" AND cct2.kind LIKE "%complete%" AND NOT chn.name LIKE "%Sherlock%" AND (chn.name LIKE "%Tony%Stark%" OR chn.name LIKE "%Iron%Man%") AND (k.keyword = "superhero" OR k.keyword = "sequel" OR k.keyword = "second-part" OR k.keyword = "marvel-comics" OR k.keyword = "based-on-comic" OR k.keyword = "tv-special" OR k.keyword = "fight" OR k.keyword = "violence") AND kt.kind = "movie" AND n.name LIKE "%Downey%Robert%" AND t.production_year > 2000 AND kt.id = t.kind_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND t.id = cc.movie_id AND mk.movie_id = ci.movie_id AND mk.movie_id = cc.movie_id AND ci.movie_id = cc.movie_id AND chn.id = ci.person_role_id AND n.id = ci.person_id AND k.id = mk.keyword_id AND cct1.id = cc.subject_id AND cct2.id = cc.status_id;'
